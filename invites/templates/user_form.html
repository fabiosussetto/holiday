{% extends 'holiday_manager/base_modal.html' %}

{% block modal_title %}
    Invite a new memeber
{% endblock %}

{% block modal_body %}
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-invite" data-toggle="tab">Invite by email</a></li>
        <li><a href="#tab-gmail" data-toggle="tab">Import your GMail contacts</a></li>
    </ul>
    <div class="tab-content">
        <div class="tab-pane active" id="tab-invite">
            <form action="{% url app:invites:invite curr_project %}" method="post" class="form-inline invite-form">{% csrf_token %}
                <div class="form-column-container">
                    <div class="form-column">
                        {% with field=form.email %}
                            {% include 'bootstrap_form.html' %}
                        {% endwith %}
                        {% with field=form.first_name %}
                            {% include 'bootstrap_form.html' %}
                        {% endwith %}
                        {% with field=form.last_name %}
                            {% include 'bootstrap_form.html' %}
                        {% endwith %}
                    </div>
                    <div class="form-column">
                        {% with field=form.approval_group %}
                            {% include 'bootstrap_form.html' %}
                        {% endwith %}
                        {% with field=form.days_off_left %}
                            {% include 'bootstrap_form.html' %}
                        {% endwith %}
                    </div>    
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary send-invite">Send invite</button>
                </div>
            </form>
        </div>
        <div class="tab-pane" id="tab-gmail">
            <form action="{% url app:invites:import_contacts curr_project %}" method="post">{% csrf_token %}
                <p class="lightColor">Select your GMail contacts to invite:</p>
                {% if oauthed %}
                    <div class="scroller contact-picker">
                        {% if contacts %}
                            <ul>
                            {% for contact in contacts %}
                                <li>
                                    <input type="checkbox" name="email" value="{{ contact.email }}">
                                    <img onerror="this.src='{{ STATIC_URL }}app/img/missing_pic.gif'" style="width:30px" src="{{ contact.pic }}">
                                    {{ contact.full_name }} ({{ contact.email }})
                                </li>
                            {% endfor %}
                            </ul>
                        {% else %}
                            <p>You don't have any contacts to import.</p>
                        {% endif %}
                    </div>
                {% else %}
                    <p>Please authorize this app to import your Gmail contacts:</p>
                    <a rel="nofollow" class="btn btn-primary btn-big" href="{% url socialauth_begin 'google-oauth2' %}?next={{ request.path }}">Login with Google</a>
                {% endif %}
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Import selected contacts</button>
                </div>
        
            </form>
        </div>
    </div>
{% endblock %}